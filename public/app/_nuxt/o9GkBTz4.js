import{_ as y,a as N,b as K}from"./CEBnf4lY.js";import{m as L}from"./CNoE1dyc.js";import{d as M,$ as T,z as D,v as E,b as $,o as V,w as f,g,a2 as F,X as e,ak as O,a3 as k,p as j,e as R,Y as Q,al as W,I as x,c as Z}from"#entry";import{u as ee}from"./STx5ny5w.js";import{u as B}from"./BrGRbLzH.js";import{_ as z,a as H}from"./Bd0EK6v7.js";import{_ as I}from"./BSWBmhT_.js";import{C as oe,U as te}from"./C-0eX2IW.js";import{b as A}from"./BHpSMavt.js";import"./D3Dcj_v8.js";import"./DpB_hE1g.js";import"./CGL4pY6L.js";import"./DpIK6lhX.js";import"./bPUzXHqf.js";import"./Bgk1oRip.js";const se=M({__name:"CreateModal",emits:["reloadTable","success","error","close"],setup(U,{emit:r}){const t=B(),{loading:s,errorBag:S,hasError:P}=T(t),o=r,{strSanitize:d}=A(),m=()=>o("close"),h=()=>{o("success"),o("reloadTable"),m()},C=()=>{o("error")},u=D({title:void 0}),i=E({get:()=>u.value.title,set:l=>{u.value.title=d(l)}}),p=async l=>{if(await t.addPermission(l.data),P.value){C();return}h()};return(l,b)=>{const v=H,_=I,c=k,a=z,n=y;return V(),$(n,{"on-close":m,title:"Create Permission"},{default:f(()=>[g(a,{schema:"CreatePermissionValidationSchema"in l?l.CreatePermissionValidationSchema:e(oe),state:e(u),onSubmit:F(p,["prevent"]),class:"space-y-6"},{default:f(()=>[g(_,{label:"Permission Title",name:"title",error:e(S).title},{default:f(()=>[g(v,{modelValue:e(i),"onUpdate:modelValue":b[0]||(b[0]=w=>O(i)?i.value=w:null)},null,8,["modelValue"])]),_:1},8,["error"]),g(c,{type:"submit",loading:e(s)},{default:f(()=>[...b[1]||(b[1]=[j(" Add ",-1)])]),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1})}}}),ne=Object.assign(se,{__name:"PermissionsCreateModal"}),ie=M({__name:"UpdateModal",props:{permission:Object},emits:["reloadTable","success","error","noDataChange","close"],setup(U,{emit:r}){const t=B(),{loading:s,errorBag:S,hasError:P}=T(t),o=r,{strSanitize:d}=A(),m=()=>o("close"),h=U,C=()=>{o("success"),o("reloadTable"),m()},u=()=>{o("error")},i=()=>{o("noDataChange")},p=D({title:h.permission?.title||void 0}),l=D({...N.cloneDeep({title:h.permission?.title||void 0})}),b=["title"],v=E(()=>b.some(a=>{const n=p.value[a],w=l.value[a];return!N.isEqual(n,w)})),_=E({get:()=>p.value.title,set:a=>{p.value.title=d(a)}}),c=async a=>{if(!v.value){i();return}if(await t.updatePermission(h.permission?.id,a.data),P.value){u();return}C()};return(a,n)=>{const w=H,G=I,q=k,X=z,Y=y;return V(),$(Y,{"on-close":m,title:"Update Permission"},{default:f(()=>[g(X,{schema:"UpdatePermissionValidationSchema"in a?a.UpdatePermissionValidationSchema:e(te),state:e(p),onSubmit:F(c,["prevent"]),class:"space-y-6"},{default:f(()=>[g(G,{label:"Permission Title",name:"title",error:e(S).title},{default:f(()=>[g(w,{modelValue:e(_),"onUpdate:modelValue":n[0]||(n[0]=J=>O(_)?_.value=J:null)},null,8,["modelValue"])]),_:1},8,["error"]),g(q,{type:"submit",loading:e(s),disabled:!e(v)},{default:f(()=>[...n[1]||(n[1]=[j(" Update ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["schema","state"])]),_:1})}}}),ae=Object.assign(ie,{__name:"PermissionsUpdateModal"}),re=M({__name:"DeleteModal",props:{permission:Object},emits:["reloadTable","success","error","close"],setup(U,{emit:r}){const t=B(),{loading:s,hasError:S}=T(t),P=U,o=r,d=()=>o("close"),m=()=>{o("success"),o("reloadTable"),d()},h=()=>{o("error")},C=async()=>{if(await t.deletePermission(P.permission?.id),S.value){h();return}m()};return(u,i)=>{const p=k,l=y;return V(),$(l,{"on-close":d,title:`Delete ${P.permission?.title}`,ui:{width:"md:max-w-1xl"}},{default:f(()=>[i[1]||(i[1]=R("p",{class:"italic"},"This action cannot be undone.",-1)),i[2]||(i[2]=R("p",{class:"italic"}," All data associated with this permission will be deleted. ",-1)),g(p,{variant:"solid",color:"red",class:"w-full justify-center mt-4",ui:{base:"text-center"},onClick:C,loading:e(s)},{default:f(()=>[...i[0]||(i[0]=[j(" Delete this permission ",-1)])]),_:1},8,["loading"])]),_:1},8,["title"])}}}),le=Object.assign(re,{__name:"PermissionsDeleteModal"}),we=M({__name:"index",setup(U){Q({title:"Permissions"});const r=W(),{actionToastResult:t}=ee(),s=B(),{permissions:S,loading:P,page:o,pageCount:d,search:m,sort:h,totalPermissions:C,selectedStatus:u}=T(s),{columns:i,items:p}=L;s.fetchPermissions();const l=()=>{r.open(ne,{onReloadTable(){s.fetchPermissions()},onSuccess(){t({icon:"i-heroicons-check-circle",description:"Permission created.",id:"modal-success",color:"green"})},onError(){t({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){r.close()}})},b=_=>{r.open(ae,{permission:_,onReloadTable(){s.fetchPermissions()},onSuccess(){t({icon:"i-heroicons-check-circle",description:"Permission updated.",id:"modal-success",color:"green"})},onError(){t({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onNoDataChange(){t({icon:"i-heroicons-exclamation-circle",description:"No data changes detected.",id:"modal-warning",color:"yellow"})},onClose(){r.close()}})},v=_=>{r.open(le,{permission:_,onReloadTable(){s.fetchPermissions()},onSuccess(){t({icon:"i-heroicons-check-circle",description:"Permission deleted.",id:"modal-success",color:"green"})},onError(){t({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){r.close()}})};return x(m,()=>{o.value=1,s.fetchPermissions()}),x(d,()=>{o.value=1,s.fetchPermissions()}),x([o,d],()=>{s.fetchPermissions()}),x(u,()=>{o.value=1,s.fetchPermissions()}),(_,c)=>{const a=K;return V(),Z("div",null,[g(a,{"module-title":"Permissions",columns:e(i),"action-items":e(p),"table-data":e(S),"add-data-modal":l,loading:e(P),"action-handlers":{edit:b,delete:v},pagination:{page:e(o),pageCount:e(d),total:e(C)},sorting:e(h),search:e(m),"selected-dropdown-filter":e(u),"onUpdate:page":c[0]||(c[0]=n=>o.value=n),"onUpdate:pageCount":c[1]||(c[1]=n=>d.value=n),"onUpdate:sort":e(s).fetchPermissions,"onUpdate:search":c[2]||(c[2]=n=>m.value=n),"onUpdate:selectedDropdownFilter":c[3]||(c[3]=n=>u.value=n)},null,8,["columns","action-items","table-data","loading","action-handlers","pagination","sorting","search","selected-dropdown-filter","onUpdate:sort"])])}}});export{we as default};
