import{v as I,P as C,a4 as P,a5 as $,z as s}from"#entry";import{u as B}from"./DYXxPDVW.js";import{u as H}from"./bPUzXHqf.js";import{u as O,a as R}from"./BHpSMavt.js";const _=()=>{const{login:o,logout:i}=B(),n=H(),{apiUrl:p}=O(),g="users",u=I(()=>p(g));return{fetchAllUsersApi:async e=>await n(`${u.value}?${e.toString()}`),authLoginApi:async e=>await o(e),fetchLoggedInUserApi:async()=>await C(),authLogoutApi:async()=>await i(),usersOptions:async(e,a=25)=>await n(`${u.value}/options`,{params:{search:e,limit:a}})}},F=P("authStore",()=>{const o=$(),{authLoginApi:i,fetchLoggedInUserApi:n,authLogoutApi:p,fetchAllUsersApi:g}=_(),{hasError:u,errorBag:m,transformValidationErrors:h,resetErrorBag:c}=R();let f;(t=>{t.ASC="asc",t.DESC="desc"})(f||(f={}));const l=s([]),e=s(null),a=s(!1),A=s(1),y=s(5),w=s("");s("");const d=s({column:"created_at",direction:"desc"}),L=s(0),U=async()=>{a.value=!0,c();try{const t=new URLSearchParams({page:A.value.toString(),per_page:y.value.toString(),sort:d.value.column,order:d.value.direction,search:w.value}),r=await g(t);l.value=r.data,console.log(l.value),L.value=Number(r.meta.total)||0}catch(t){h(t)}finally{a.value=!1}},S=async t=>{a.value=!0,c();try{await i(t),await v(),(e.value?.roles??[]).map(E=>E.title).includes("judge")?await o.push("/scores"):await o.push("/control-panel")}catch(r){h(r)}finally{a.value=!1}},v=async()=>{a.value=!0,c();try{const t=await n();e.value=t}catch(t){throw t}finally{a.value=!1}};return{loading:a,errorBag:m,hasError:u,authLogin:S,fetchLoggedInUser:v,fetchUsers:U,authLogout:async()=>{await p(),e.value=null},loggedInUser:e,users:l}});export{F as u};
