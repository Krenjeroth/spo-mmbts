import{v as w,a4 as $,z as c}from"#entry";import{u as P}from"./bPUzXHqf.js";import{u as B,a as U}from"./BHpSMavt.js";function I(){const s=P(),{apiUrl:l}=B(),v="pageant-events",r=w(()=>l(v));return{fetchEventsApi:async e=>await s(`${r.value}?${e.toString()}`),fetchEventApi:async e=>await s(`${r.value}/${e}`),addEventApi:async e=>await s(`${r.value}`,{method:"POST",body:e}),updateEventApi:async(e,n)=>await s(`${r.value}/${e}`,{method:"PUT",body:n}),deleteEventApi:async e=>await s(`${r.value}/${e}`,{method:"DELETE"}),searchEventsApi:async e=>{const n=e?.toString()||"";return await s(`${r.value}-search?${n}`)}}}const _=$("events",()=>{const{fetchEventsApi:s,addEventApi:l,updateEventApi:v,deleteEventApi:r,searchEventsApi:p}=I(),{hasError:h,errorBag:y,transformValidationErrors:o,resetErrorBag:u}=U();let i;(a=>{a.ASC="asc",a.DESC="desc"})(i||(i={}));const e=c([]),n=c(!1),f=c(1),m=c(5),A=c(""),d=c(""),E=c({column:"created_at",direction:"desc"}),g=c(0);return{events:e,loading:n,hasError:h,errorBag:y,page:f,pageCount:m,search:A,selectedStatus:d,sort:E,totalEvents:g,fetchEvents:async()=>{n.value=!0,u();try{const a=new URLSearchParams({page:f.value.toString(),per_page:m.value.toString(),sort:E.value.column,order:E.value.direction,search:A.value,...d.value?{status:d.value}:{}}),t=await s(a);e.value=t.data??t,console.log(e.value),g.value=Number(t.meta.total)||0}catch(a){o(a)}finally{n.value=!1}},addEvent:async a=>{n.value=!0,u();try{const t=await l(a);e.value.push(t.data??t)}catch(t){o(t)}finally{n.value=!1}},updateEventById:async(a,t)=>{n.value=!0,u(),await v(a,t).catch(S=>{o(S)}).finally(()=>{n.value=!1})},deleteEventById:async a=>{n.value=!0,u();try{await r(a),e.value=e.value.filter(t=>t.id!==a)}catch(t){o(t)}finally{n.value=!1}},searchEvents:async a=>{try{const t=new URLSearchParams({q:a,limit:"50"});return(await p(t)).data}catch(t){return console.error("API Error:",t),[]}}}});export{_ as u};
