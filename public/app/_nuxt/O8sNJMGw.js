import{_ as F,a as P,b as Z}from"./CEBnf4lY.js";import{m as ee}from"./LrwBxbMR.js";import{d as k,$ as x,z as j,b as B,o as U,w as m,g as u,a2 as I,X as e,e as E,c as A,F as G,j as H,a3 as N,p as O,v as oe,Y as te,al as se,I as D}from"#entry";import{u as ne}from"./STx5ny5w.js";import{u as y}from"./FhQF6-l6.js";import{_ as q,a as z}from"./Bd0EK6v7.js";import{_ as L}from"./BSWBmhT_.js";import{b as X}from"./D3Dcj_v8.js";import{C as le,U as ae}from"./BfYD3bRy.js";import{u as Y}from"./BrGRbLzH.js";import"./DpB_hE1g.js";import"./CGL4pY6L.js";import"./DpIK6lhX.js";import"./BHpSMavt.js";import"./bPUzXHqf.js";import"./Bgk1oRip.js";const re={class:"grid grid-cols-2 gap-1"},ie=k({__name:"CreateModal",emits:["reloadTable","success","error","close"],setup(V,{emit:c}){const n=y(),o=Y(),{permissionsAll:C}=x(o);o.fetchPermissionsAll();const{loading:R,errorBag:s,hasError:p}=x(n),l=c,b=()=>l("close"),_=()=>{l("success"),l("reloadTable"),b()},S=()=>{l("error")},a=j({title:void 0,permission_ids:[]}),v=async i=>{if(await n.addRole(i.data),p.value){S();return}_()};return(i,f)=>{const M=z,g=L,d=X,r=N,t=q,T=F;return U(),B(T,{"on-close":b,title:"Create Role"},{default:m(()=>[u(t,{schema:"CreateRoleValidationSchema"in i?i.CreateRoleValidationSchema:e(le),state:e(a),onSubmit:I(v,["prevent"]),class:"space-y-6"},{default:m(()=>[u(g,{label:"Role Title",name:"title",error:e(s).title},{default:m(()=>[u(M,{modelValue:e(a).title,"onUpdate:modelValue":f[0]||(f[0]=h=>e(a).title=h)},null,8,["modelValue"])]),_:1},8,["error"]),u(g,{label:"Permissions",name:"permission_ids",error:e(s).permission_ids},{default:m(()=>[E("div",re,[(U(!0),A(G,null,H(e(C),h=>(U(),B(d,{key:h.id,modelValue:e(a).permission_ids,"onUpdate:modelValue":f[1]||(f[1]=$=>e(a).permission_ids=$),value:h.id,id:h.title,label:h.title},null,8,["modelValue","value","id","label"]))),128))])]),_:1},8,["error"]),u(r,{type:"submit",loading:e(R)},{default:m(()=>[...f[2]||(f[2]=[O(" Add ",-1)])]),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1})}}}),ce=Object.assign(ie,{__name:"RolesCreateModal"}),de={class:"grid grid-cols-2 gap-1"},me=k({__name:"UpdateModal",props:{role:Object},emits:["reloadTable","success","error","noDataChange","close"],setup(V,{emit:c}){const n=y(),o=Y(),{permissionsAll:C}=x(o);o.fetchPermissionsAll();const{loading:R,errorBag:s,hasError:p}=x(n),l=c,b=()=>l("close"),_=V,S=()=>{l("success"),l("reloadTable"),b()},a=()=>{l("error")},v=()=>{l("noDataChange")},i=j({title:_.role?.title||void 0,permission_ids:_.role?.permissions.map(r=>r.id)||[]}),f=j({...P.cloneDeep({title:_.role?.title||void 0,permission_ids:_.role?.permissions.map(r=>r.id)||[]})}),M=["title","permission_ids"],g=oe(()=>M.some(r=>{const t=i.value[r],T=f.value[r];return!P.isEqual(t,T)})),d=async r=>{if(!g.value){v();return}if(console.log(r.data),await n.updateRole(_.role?.id,r.data),p.value){a();return}S()};return(r,t)=>{const T=z,h=L,$=X,J=N,K=q,Q=F;return U(),B(Q,{"on-close":b,title:"Update Role"},{default:m(()=>[u(K,{schema:"UpdateRoleValidationSchema"in r?r.UpdateRoleValidationSchema:e(ae),state:e(i),onSubmit:I(d,["prevent"]),class:"space-y-6"},{default:m(()=>[u(h,{label:"Role Title",name:"title",error:e(s).title},{default:m(()=>[u(T,{modelValue:e(i).title,"onUpdate:modelValue":t[0]||(t[0]=w=>e(i).title=w)},null,8,["modelValue"])]),_:1},8,["error"]),u(h,{label:"Permissions",name:"permission_ids",error:e(s).permission_ids},{default:m(()=>[E("div",de,[(U(!0),A(G,null,H(e(C),w=>(U(),B($,{key:w.id,modelValue:e(i).permission_ids,"onUpdate:modelValue":t[1]||(t[1]=W=>e(i).permission_ids=W),value:w.id,id:w.title,label:w.title},null,8,["modelValue","value","id","label"]))),128))])]),_:1},8,["error"]),u(J,{type:"submit",loading:e(R),disabled:!e(g)},{default:m(()=>[...t[2]||(t[2]=[O(" Update ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["schema","state"])]),_:1})}}}),ue=Object.assign(me,{__name:"RolesUpdateModal"}),pe=k({__name:"DeleteModal",props:{role:Object},emits:["reloadTable","success","error","close"],setup(V,{emit:c}){const n=y(),{loading:o,hasError:C}=x(n),R=V,s=c,p=()=>s("close"),l=()=>{s("success"),s("reloadTable"),p()},b=()=>{s("error")},_=async()=>{if(await n.deleteRole(R.role?.id),C.value){b();return}l()};return(S,a)=>{const v=N,i=F;return U(),B(i,{"on-close":p,title:`Delete ${R.role?.title}`,ui:{width:"md:max-w-1xl"}},{default:m(()=>[a[1]||(a[1]=E("p",{class:"italic"},"This action cannot be undone.",-1)),a[2]||(a[2]=E("p",{class:"italic"},"All data associated with this role will be deleted.",-1)),u(v,{variant:"solid",color:"red",class:"w-full justify-center mt-4",ui:{base:"text-center"},onClick:_,loading:e(o)},{default:m(()=>[...a[0]||(a[0]=[O(" Delete this role ",-1)])]),_:1},8,["loading"])]),_:1},8,["title"])}}}),_e=Object.assign(pe,{__name:"RolesDeleteModal"}),Ee=k({__name:"index",setup(V){te({title:"Roles"});const c=se(),{actionToastResult:n}=ne(),o=y(),{roles:C,loading:R,page:s,pageCount:p,search:l,sort:b,totalRoles:_,selectedStatus:S}=x(o),{columns:a,items:v}=ee;o.fetchRoles();const i=()=>{c.open(ce,{onReloadTable(){o.fetchRoles()},onSuccess(){n({icon:"i-heroicons-check-circle",description:"Role created.",id:"modal-success",color:"green"})},onError(){n({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){c.close()}})},f=g=>{c.open(ue,{role:g,onReloadTable(){o.fetchRoles()},onSuccess(){n({icon:"i-heroicons-check-circle",description:"Role updated.",id:"modal-success",color:"green"})},onError(){n({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onNoDataChange(){n({icon:"i-heroicons-exclamation-circle",description:"No data changes detected.",id:"modal-warning",color:"yellow"})},onClose(){c.close()}})},M=g=>{c.open(_e,{role:g,onReloadTable(){o.fetchRoles()},onSuccess(){n({icon:"i-heroicons-check-circle",description:"Role deleted.",id:"modal-success",color:"green"})},onError(){n({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){c.close()}})};return D(l,()=>{s.value=1,o.fetchRoles()}),D(p,()=>{s.value=1,o.fetchRoles()}),D([s,p],()=>{o.fetchRoles()}),D(S,()=>{s.value=1,o.fetchRoles()}),(g,d)=>{const r=Z;return U(),A("div",null,[u(r,{"module-title":"Roles",columns:e(a),"action-items":e(v),"table-data":e(C),"add-data-modal":i,loading:e(R),"action-handlers":{edit:f,delete:M},pagination:{page:e(s),pageCount:e(p),total:e(_)},sorting:e(b),search:e(l),"selected-dropdown-filter":e(S),"onUpdate:page":d[0]||(d[0]=t=>s.value=t),"onUpdate:pageCount":d[1]||(d[1]=t=>p.value=t),"onUpdate:sort":e(o).fetchRoles,"onUpdate:search":d[2]||(d[2]=t=>l.value=t),"onUpdate:selectedDropdownFilter":d[3]||(d[3]=t=>S.value=t)},null,8,["columns","action-items","table-data","loading","action-handlers","pagination","sorting","search","selected-dropdown-filter","onUpdate:sort"])])}}});export{Ee as default};
