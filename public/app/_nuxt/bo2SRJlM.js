import{_ as J,a as G,b as de}from"./CEBnf4lY.js";import{m as ue}from"./76UMqK1m.js";import{_ as ce,d as F,c as z,o as M,e as H,h as pe,m as me,n as fe,q as ve,u as he,s as Q,z as T,x as ge,a0 as R,I as k,ap as _e,v as X,C as ye,D as be,E as q,aq as we,a7 as Se,$ as D,b as Y,w as v,g as c,a2 as K,X as t,t as L,a3 as W,p as Z,a6 as Ce,Y as Ue,al as Ve}from"#entry";import{b as Te}from"./BHpSMavt.js";import{u as Pe}from"./STx5ny5w.js";import{u as A}from"./yF1_bWGY.js";import{_ as ee}from"./HtYbEshO.js";import{u as xe,_ as te}from"./BSWBmhT_.js";import{_ as ae,a as oe}from"./Bd0EK6v7.js";import{C as Be,U as Ee}from"./Btqvjtym.js";import{u as ne}from"./2jTwVr-P.js";import"./D3Dcj_v8.js";import"./DpB_hE1g.js";import"./CGL4pY6L.js";import"./DpIK6lhX.js";import"./bPUzXHqf.js";import"./Bgk1oRip.js";const E=ve(q.ui.strategy,q.ui.textarea,we),Me=F({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(E.size).includes(e)}},color:{type:String,default:()=>E.default.color,validator(e){return[...q.ui.colors,...Object.keys(E.color)].includes(e)}},variant:{type:String,default:()=>E.default.variant,validator(e){return[...Object.keys(E.variant),...Object.values(E.color).flatMap(r=>Object.keys(r))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:r}){const{ui:l,attrs:$}=he("textarea",Q(e,"ui"),E,Q(e,"class")),{emitFormBlur:P,emitFormInput:h,inputId:f,color:d,size:x,name:N}=xe(e,E),n=T(ge({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),a=T(null),y=()=>{e.autofocus&&a.value?.focus()},S=()=>{if(e.autoresize){if(!a.value)return;a.value.rows=e.rows;const o=a.value.style.overflow;a.value.style.overflow="hidden";const i=window.getComputedStyle(a.value),p=Number.parseInt(i.paddingTop),m=Number.parseInt(i.paddingBottom),w=p+m,s=Number.parseInt(i.lineHeight),{scrollHeight:u}=a.value,C=(u-w)/s;C>e.rows&&(a.value.rows=e.maxrows?Math.min(C,e.maxrows):C),a.value.style.overflow=o}},B=o=>{n.value.trim&&(o=o.trim()),n.value.number&&(o=Se(o)),n.value.nullify&&(o||=null),r("update:modelValue",o),h()},_=o=>{S(),n.value.lazy||B(o.target.value)},g=o=>{const i=o.target.value;r("change",i),n.value.lazy&&B(i),n.value.trim&&(o.target.value=i.trim())},I=o=>{r("blur",o),P()};R(()=>{setTimeout(()=>{y()},e.autofocusDelay)}),k(()=>e.modelValue,()=>{_e(S)}),R(()=>{setTimeout(()=>{y(),S()},100)});const b=X(()=>{const o=l.value.color?.[d.value]?.[e.variant]||l.value.variant[e.variant];return ye(be(l.value.base,l.value.form,l.value.rounded,l.value.placeholder,l.value.size[x.value],e.padded?l.value.padding[x.value]:"p-0",o?.replaceAll("{color}",d.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:l,attrs:$,name:N,inputId:f,textarea:a,textareaClass:b,onInput:_,onChange:g,onBlur:I}}}),$e=["id","value","name","rows","required","disabled","placeholder"];function Ne(e,r,l,$,P,h){return M(),z("div",{class:fe(e.ui.wrapper)},[H("textarea",me({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:r[0]||(r[0]=(...f)=>e.onInput&&e.onInput(...f)),onBlur:r[1]||(r[1]=(...f)=>e.onBlur&&e.onBlur(...f)),onChange:r[2]||(r[2]=(...f)=>e.onChange&&e.onChange(...f))}),null,16,$e),pe(e.$slots,"default")],2)}const se=Object.assign(ce(Me,[["render",Ne]]),{__name:"UTextarea"}),Ie={class:"truncate"},Oe={key:0,class:"text-gray-400"},ze={key:1,class:"text-gray-400"},ke=F({__name:"CreateModal",props:{pageTitle:String},emits:["reloadTable","success","error","close"],setup(e,{emit:r}){const l=A(),{phases:$,loading:P,errorBag:h,hasError:f}=D(l);l.fetchPhases();const d=ne(),{events:x,loading:N}=D(d),n=r,a=e,y=()=>n("close"),S=()=>{n("success"),n("reloadTable"),y()},B=()=>{n("error")},_=T({event_id:void 0,name:void 0,description:void 0,order:void 0}),g=async i=>{if(i.data.event_id=i.data.event_id?.id,await l.addPhase(i.data),f.value){B();return}S()},I=T(x.value),b=T(""),o=async i=>{if(b.value=i,!b.value||b.value.length<2)return[];const p=await d.searchEvents(b.value);return I.value=p,p};return R(()=>{d.fetchEvents()}),(i,p)=>{const m=ee,w=te,s=oe,u=se,C=W,O=ae,j=J;return M(),Y(j,{"on-close":y,title:`Create ${a.pageTitle}`},{default:v(()=>[c(O,{schema:"CreatePhaseValidationSchema"in i?i.CreatePhaseValidationSchema:t(Be),state:t(_),onSubmit:K(g,["prevent"]),class:"space-y-6"},{default:v(()=>[c(w,{label:"Event",name:"event_id",error:t(h).event_id,search:o,ui:{wrapper:"md:w-full"}},{default:v(()=>[c(m,{modelValue:t(_).event_id,"onUpdate:modelValue":p[0]||(p[0]=U=>t(_).event_id=U),search:o,loading:t(N),placeholder:"Type to search...","option-attribute":"title"},{option:v(({option:U})=>[H("span",Ie,L(U.title),1)]),empty:v(()=>[t(b).length<2?(M(),z("span",Oe,"Type at least 2 characters...")):(M(),z("span",ze,"No event found"))]),_:1},8,["modelValue","loading"])]),_:1},8,["error"]),c(w,{label:"Name",name:"name",error:t(h).name},{default:v(()=>[c(s,{modelValue:t(_).name,"onUpdate:modelValue":p[1]||(p[1]=U=>t(_).name=U)},null,8,["modelValue"])]),_:1},8,["error"]),c(w,{label:"Description",name:"description",error:t(h).description},{default:v(()=>[c(u,{modelValue:t(_).description,"onUpdate:modelValue":p[2]||(p[2]=U=>t(_).description=U)},null,8,["modelValue"])]),_:1},8,["error"]),c(C,{type:"submit",loading:t(P)},{default:v(()=>[...p[3]||(p[3]=[Z(" Add ",-1)])]),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1},8,["title"])}}}),De=Object.assign(ke,{__name:"PhasesCreateModal"}),je={class:"truncate"},Fe={key:0,class:"text-gray-400"},Re={key:1,class:"text-gray-400"},qe=F({__name:"UpdateModal",props:{pageTitle:String,phase:Object},emits:["reloadTable","success","error","noDataChange","close"],setup(e,{emit:r}){const l=A(),{phases:$,loading:P,errorBag:h,hasError:f}=D(l);l.fetchPhases();const d=ne(),{events:x,loading:N}=D(d),n=r,a=e,y=()=>n("close"),S=()=>{n("success"),n("reloadTable"),y()},B=()=>{n("error")},_=()=>{n("noDataChange")},g=T({event_id:a.phase?.event||void 0,name:a.phase?.name||void 0,description:a.phase?.description||void 0,order:a.phase?.order||void 0}),I=T({...G.cloneDeep({event_id:a.phase?.event||void 0,name:a.phase?.name||void 0,description:a.phase?.description||void 0,order:a.phase?.order||void 0})}),b=["event_id","name","description","order"],o=X(()=>b.some(s=>{const u=g.value[s],C=I.value[s];return!G.isEqual(u,C)})),i=async s=>{if(!o.value){_();return}if(s.data.event_id=s.data.event_id?.id,await l.updatePhase(a.phase?.id,s.data),f.value){B();return}S()},p=T(x.value),m=T(""),w=async s=>{if(m.value=s,!m.value||m.value.length<2)return[];const u=await d.searchEvents(m.value);return p.value=u,u};return(s,u)=>{const C=ee,O=te,j=oe,U=se,re=W,le=ae,ie=J;return M(),Y(ie,{"on-close":y,title:`Update ${a.pageTitle}`},{default:v(()=>[c(le,{schema:"UpdatePhaseValidationSchema"in s?s.UpdatePhaseValidationSchema:t(Ee),state:t(g),onSubmit:K(i,["prevent"]),class:"space-y-6"},{default:v(()=>[c(O,{label:"Event",name:"event_id",error:t(h).event_id,search:w,ui:{wrapper:"md:w-full"}},{default:v(()=>[c(C,{modelValue:t(g).event_id,"onUpdate:modelValue":u[0]||(u[0]=V=>t(g).event_id=V),search:w,loading:t(N),placeholder:"Type to search...","option-attribute":"title"},{option:v(({option:V})=>[H("span",je,L(V.title),1)]),empty:v(()=>[t(m).length<2?(M(),z("span",Fe,"Type at least 2 characters...")):(M(),z("span",Re,"No event found"))]),_:1},8,["modelValue","loading"])]),_:1},8,["error"]),c(O,{label:"Name",name:"name",error:t(h).name},{default:v(()=>[c(j,{modelValue:t(g).name,"onUpdate:modelValue":u[1]||(u[1]=V=>t(g).name=V)},null,8,["modelValue"])]),_:1},8,["error"]),c(O,{label:"Description",name:"description",error:t(h).description},{default:v(()=>[c(U,{modelValue:t(g).description,"onUpdate:modelValue":u[2]||(u[2]=V=>t(g).description=V)},null,8,["modelValue"])]),_:1},8,["error"]),c(O,{label:"Order",name:"order",error:t(h).order},{default:v(()=>[c(j,{modelValue:t(g).order,"onUpdate:modelValue":u[3]||(u[3]=V=>t(g).order=V),type:"number"},null,8,["modelValue"])]),_:1},8,["error"]),c(re,{type:"submit",loading:t(P),disabled:!t(o)},{default:v(()=>[...u[4]||(u[4]=[Z(" Update ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["schema","state"])]),_:1},8,["title"])}}}),He=Object.assign(qe,{__name:"PhasesUpdateModal"}),lt=F({__name:"index",setup(e){const r=Ce();Ue({title:()=>r.meta.title});const{strSingular:l}=Te(),$=l(r.meta.title),P=r.meta.title,h=Ve(),{actionToastResult:f}=Pe(),d=A(),{phases:x,loading:N,page:n,pageCount:a,search:y,sort:S,totalPhases:B,selectedStatus:_}=D(d),{columns:g,items:I,statusOptions:b}=ue;d.fetchPhases();const o=()=>{h.open(De,{pageTitle:$,onReloadTable(){d.fetchPhases()},onSuccess(){f({icon:"i-heroicons-check-circle",description:"Event created.",id:"modal-success",color:"green"})},onError(){f({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){h.close()}})},i=p=>{h.open(He,{pageTitle:$,phase:p,onReloadTable(){d.fetchPhases()},onSuccess(){f({icon:"i-heroicons-check-circle",description:"Event updated.",id:"modal-success",color:"green"})},onError(){f({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onNoDataChange(){f({icon:"i-heroicons-exclamation-circle",description:"No data changes detected.",id:"modal-warning",color:"yellow"})},onClose(){h.close()}})};return k(y,()=>{n.value=1,d.fetchPhases()}),k(a,()=>{n.value=1,d.fetchPhases()}),k([n,a],()=>{d.fetchPhases()}),k(_,()=>{n.value=1,d.fetchPhases()}),(p,m)=>{const w=de;return M(),z("div",null,[c(w,{"module-title":t(P),columns:t(g),"action-items":t(I),"table-data":t(x),"add-data-modal":o,loading:t(N),"action-handlers":{edit:i},pagination:{page:t(n),pageCount:t(a),total:t(B)},sorting:t(S),search:t(y),"selected-dropdown-filter":t(_),"enable-dropdown-filter":!0,"dropdown-filter-options":t(b),"onUpdate:page":m[0]||(m[0]=s=>n.value=s),"onUpdate:pageCount":m[1]||(m[1]=s=>a.value=s),"onUpdate:sort":t(d).fetchPhases,"onUpdate:search":m[2]||(m[2]=s=>y.value=s),"onUpdate:selectedDropdownFilter":m[3]||(m[3]=s=>_.value=s)},null,8,["module-title","columns","action-items","table-data","loading","action-handlers","pagination","sorting","search","selected-dropdown-filter","dropdown-filter-options","onUpdate:sort"])])}}});export{lt as default};
