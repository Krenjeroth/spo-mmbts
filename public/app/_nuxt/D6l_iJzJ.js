import{v as $,a4 as b,z as c}from"#entry";import{u as P}from"./bPUzXHqf.js";import{u as U,a as L,b as B}from"./BHpSMavt.js";function T(){const o=P(),{apiUrl:g}=U(),y="categories",n=$(()=>g(y));return{fetchCategoriesApi:async a=>await o(`${n.value}?${a.toString()}`),fetchCategoryApi:async a=>await o(`${n.value}/${a}`),addCategoryApi:async a=>await o(`${n.value}`,{method:"POST",body:a}),updateCategoryApi:async(a,r)=>await o(`${n.value}/${a}`,{method:"PUT",body:r}),deleteCategoryApi:async a=>await o(`${n.value}/${a}`,{method:"DELETE"}),fetchCategoriesSelectApi:async()=>await o(`${n.value}-select`)}}const O=b("categories",()=>{const{fetchCategoriesApi:o,addCategoryApi:g,updateCategoryApi:y,deleteCategoryApi:n,fetchCategoriesSelectApi:p}=T(),{hasError:f,errorBag:h,transformValidationErrors:u,resetErrorBag:i}=L(),{capitalizeWords:d}=B();let a;(e=>{e.ASC="asc",e.DESC="desc"})(a||(a={}));const r=c([]),m=c([]),s=c(!1),S=c(1),A=c(5),w=c(""),E=c(""),C=c({column:"created_at",direction:"desc"}),v=c(0);return{categories:r,categoriesSelect:m,loading:s,hasError:f,errorBag:h,page:S,pageCount:A,search:w,selectedStatus:E,sort:C,totalCategories:v,fetchCategories:async()=>{s.value=!0,i();try{const e=new URLSearchParams({page:S.value.toString(),per_page:A.value.toString(),sort:C.value.column,order:C.value.direction,search:w.value}),t=await o(e);r.value=t.data,console.log(r.value),v.value=Number(t.meta.total)||0}catch(e){u(e)}finally{s.value=!1}},fetchCategoriesByEvent:async e=>{s.value=!0,i();try{const t=new URLSearchParams({event_id:e.toString(),per_page:"999"}),l=await o(t);r.value=l.data,console.log("categories by event: "+r.value),v.value=Number(l.meta.total)||0}catch(t){u(t)}finally{s.value=!1}},addCategory:async e=>{s.value=!0,i(),e.name=d(e.name),e.slug=e.name.toLowerCase().replace(/\s+/g,"-");try{const t=await g(e);r.value.push(t.data??t)}catch(t){u(t)}finally{s.value=!1}},updateCategory:async(e,t)=>{s.value=!0,i(),t.name=d(t.name),t.slug=t.name.toLowerCase().replace(/\s+/g,"-");try{const l=await y(e,t);r.value.push(l.data??l)}catch(l){u(l)}finally{s.value=!1}},deleteCategory:async e=>{s.value=!0,i();try{await n(e),r.value=r.value.filter(t=>t.id!==e)}catch(t){u(t)}finally{s.value=!1}},fetchCategoriesSelect:async()=>{try{const e=await p();m.value=e.data}catch(e){console.log(e)}}}});export{O as u};
