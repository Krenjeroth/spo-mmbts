import{v as I,P as C,a4 as P,a5 as $,z as a}from"#entry";import{u as B}from"./DYXxPDVW.js";import{u as H}from"./bPUzXHqf.js";import{u as O,a as R}from"./CFo5vVrQ.js";const _=()=>{const{login:o,logout:i}=B(),n=H(),{apiUrl:g}=O(),p="users",u=I(()=>g(p));return{fetchAllUsersApi:async e=>await n(`${u.value}?${e.toString()}`),authLoginApi:async e=>await o(e),fetchLoggedInUserApi:async()=>await C(),authLogoutApi:async()=>await i(),usersOptions:async(e,s=25)=>await n(`${u.value}/options`,{params:{search:e,limit:s}})}},F=P("authStore",()=>{const o=$(),{authLoginApi:i,fetchLoggedInUserApi:n,authLogoutApi:g,fetchAllUsersApi:p}=_(),{hasError:u,errorBag:m,transformValidationErrors:h,resetErrorBag:c}=R();let f;(t=>{t.ASC="asc",t.DESC="desc"})(f||(f={}));const l=a([]),e=a(null),s=a(!1),A=a(1),y=a(5),w=a("");a("");const v=a({column:"created_at",direction:"desc"}),L=a(0),U=async()=>{s.value=!0,c();try{const t=new URLSearchParams({page:A.value.toString(),per_page:y.value.toString(),sort:v.value.column,order:v.value.direction,search:w.value}),r=await p(t);l.value=r.data,console.log(l.value),L.value=Number(r.meta.total)||0}catch(t){h(t)}finally{s.value=!1}},S=async t=>{s.value=!0,c();try{await i(t),await d(),(e.value?.roles??[]).map(E=>E.title).includes("judge")?await o.push("/scores"):await o.push("/events")}catch(r){h(r)}finally{s.value=!1}},d=async()=>{s.value=!0,c();try{const t=await n();e.value=t}catch(t){throw t}finally{s.value=!1}};return{loading:s,errorBag:m,hasError:u,authLogin:S,fetchLoggedInUser:d,fetchUsers:U,authLogout:async()=>{await g(),e.value=null},loggedInUser:e,users:l}});export{F as u};
