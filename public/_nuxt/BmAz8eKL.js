import{c as O,_ as j,a as k,b as L}from"./XCtYQKhb.js";import{m as Q}from"./CmC5zI6D.js";import{d as P,$ as E,z as N,e as q,o as F,w as r,g as a,a2 as H,X as e,p as T,t as D,a as I,a3 as G,v as Z,a6 as ee,Y as oe,al as te,I as $,c as ae}from"#entry";import{b as ne}from"./CFo5vVrQ.js";import{u as re}from"./STx5ny5w.js";import{u as R}from"./Ba5Lnm1G.js";import{_ as W}from"./_9ZTpig7.js";import{_ as z,a as A}from"./C8qUqt0S.js";import{C as se,U as le}from"./CXA8dOOg.js";import{u as X}from"./DZ2uQVpg.js";import"./DKItBGiq.js";import"./DpB_hE1g.js";import"./CJ5zKL8B.js";import"./DRvGcOf2.js";import"./bPUzXHqf.js";import"./Bgk1oRip.js";const ie=P({__name:"CreateModal",props:{pageTitle:String},emits:["reloadTable","success","error","close"],setup(B,{emit:S}){const w=R(),{loading:V,errorBag:m,hasError:C}=E(w),g=X(),{phases:u,loading:x}=E(g);g.fetchPhases();const c=S,o=B,_=()=>c("close"),U=()=>{c("success"),c("reloadTable"),_()},M=()=>{c("error")},p=N({phase_id:void 0,name:void 0,weight:void 0,slug:void 0}),s=async h=>{if(console.log(h.data),await w.addCategory(h.data),C.value){M();return}U()};return(h,l)=>{const v=O,b=W,i=A,n=G,d=z,y=j;return F(),q(y,{"on-close":_,title:`Create ${o.pageTitle}`},{default:r(()=>[a(d,{schema:"CreateCategoryValidationSchema"in h?h.CreateCategoryValidationSchema:e(se),state:e(p),onSubmit:H(s,["prevent"]),class:"space-y-6"},{default:r(()=>[a(b,{label:"Phase",name:"phase_id",error:e(m).phase_id,ui:{wrapper:"md:w-full"}},{default:r(()=>[a(v,{modelValue:e(p).phase_id,"onUpdate:modelValue":l[0]||(l[0]=t=>e(p).phase_id=t),options:e(u),searchable:!0,loading:e(x),placeholder:"Type to search...","value-attribute":"id","option-attribute":"event_phase"},{"option-empty":r(({query:t})=>[I("q",null,D(t),1),l[4]||(l[4]=T(" not found ",-1))]),empty:r(()=>[T(" No "+D(o.pageTitle)+" found ",1)]),_:1},8,["modelValue","options","loading"])]),_:1},8,["error"]),a(b,{label:"Category",name:"name",error:e(m).name},{default:r(()=>[a(i,{modelValue:e(p).name,"onUpdate:modelValue":l[1]||(l[1]=t=>e(p).name=t)},null,8,["modelValue"])]),_:1},8,["error"]),a(b,{label:"Slug",name:"slug",error:e(m).slug},{default:r(()=>[a(i,{modelValue:e(p).slug,"onUpdate:modelValue":l[2]||(l[2]=t=>e(p).slug=t)},null,8,["modelValue"])]),_:1},8,["error"]),a(b,{label:"Weight",name:"weight",error:e(m).weight},{default:r(()=>[a(i,{modelValue:e(p).weight,"onUpdate:modelValue":l[3]||(l[3]=t=>e(p).weight=t),type:"number",step:"0.1"},null,8,["modelValue"])]),_:1},8,["error"]),a(n,{type:"submit",loading:e(V)},{default:r(()=>[...l[5]||(l[5]=[T(" Add ",-1)])]),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1},8,["title"])}}}),de=Object.assign(ie,{__name:"CategoriesCreateModal"}),ue=P({__name:"UpdateModal",props:{pageTitle:String,category:Object},emits:["reloadTable","success","error","noDataChange","close"],setup(B,{emit:S}){const w=R(),{loading:V,errorBag:m,hasError:C}=E(w),g=X(),{phases:u,loading:x}=E(g);g.fetchPhases();const c=S,o=B,_=()=>c("close"),U=()=>{c("success"),c("reloadTable"),_()},M=()=>{c("error")},p=()=>{c("noDataChange")},s=N({phase_id:o.category?.phase_id||void 0,name:o.category?.name||void 0,weight:o.category?.weight||void 0,slug:o.category?.slug||void 0}),h=N({...k.cloneDeep({phase_id:o.category?.phase_id||void 0,name:o.category?.name||void 0,weight:o.category?.weight||void 0,slug:o.category?.slug||void 0})}),l=["phase_id","name","weight","slug"],v=Z(()=>l.some(i=>{const n=s.value[i],d=h.value[i];return!k.isEqual(n,d)})),b=async i=>{if(!v.value){p();return}if(console.log(i.data),await w.updateCategory(o.category?.id,i.data),C.value){M();return}U()};return(i,n)=>{const d=O,y=W,t=A,Y=G,J=z,K=j;return F(),q(K,{"on-close":_,title:`Update ${o.pageTitle}`},{default:r(()=>[a(J,{schema:"UpdateCategoryValidationSchema"in i?i.UpdateCategoryValidationSchema:e(le),state:e(s),onSubmit:H(b,["prevent"]),class:"space-y-6"},{default:r(()=>[a(y,{label:"Phase",name:"phase_id",error:e(m).phase_id,ui:{wrapper:"md:w-full"}},{default:r(()=>[a(d,{modelValue:e(s).phase_id,"onUpdate:modelValue":n[0]||(n[0]=f=>e(s).phase_id=f),options:e(u),searchable:!0,loading:e(x),placeholder:"Type to search...","value-attribute":"id","option-attribute":"event_phase"},{"option-empty":r(({query:f})=>[I("q",null,D(f),1),n[4]||(n[4]=T(" not found ",-1))]),empty:r(()=>[T(" No "+D(o.pageTitle)+" found ",1)]),_:1},8,["modelValue","options","loading"])]),_:1},8,["error"]),a(y,{label:"Category",name:"name",error:e(m).name},{default:r(()=>[a(t,{modelValue:e(s).name,"onUpdate:modelValue":n[1]||(n[1]=f=>e(s).name=f)},null,8,["modelValue"])]),_:1},8,["error"]),a(y,{label:"Slug",name:"slug",error:e(m).slug},{default:r(()=>[a(t,{modelValue:e(s).slug,"onUpdate:modelValue":n[2]||(n[2]=f=>e(s).slug=f)},null,8,["modelValue"])]),_:1},8,["error"]),a(y,{label:"Weight",name:"weight",error:e(m).weight},{default:r(()=>[a(t,{modelValue:e(s).weight,"onUpdate:modelValue":n[3]||(n[3]=f=>e(s).weight=f),type:"number",step:"0.1"},null,8,["modelValue"])]),_:1},8,["error"]),a(Y,{type:"submit",loading:e(V),disabled:!e(v)},{default:r(()=>[...n[5]||(n[5]=[T(" Update ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["schema","state"])]),_:1},8,["title"])}}}),pe=Object.assign(ue,{__name:"CategoriesUpdateModal"}),Me=P({__name:"index",setup(B){const S=ee();oe({title:()=>S.meta.title});const{strSingular:w}=ne(),V=w(S.meta.title),m=S.meta.title,C=te(),{actionToastResult:g}=re(),u=R(),{categories:x,loading:c,page:o,pageCount:_,search:U,sort:M,totalCategories:p,selectedStatus:s}=E(u),{columns:h,items:l,statusOptions:v}=Q;u.fetchCategories();const b=()=>{C.open(de,{pageTitle:V,onReloadTable(){u.fetchCategories()},onSuccess(){g({icon:"i-heroicons-check-circle",description:"Event created.",id:"modal-success",color:"green"})},onError(){g({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onClose(){C.close()}})},i=n=>{C.open(pe,{pageTitle:V,category:n,onReloadTable(){u.fetchCategories()},onSuccess(){g({icon:"i-heroicons-check-circle",description:"Event updated.",id:"modal-success",color:"green"})},onError(){g({icon:"i-heroicons-x-circle",description:"Something went wrong.",id:"modal-error",color:"red"})},onNoDataChange(){g({icon:"i-heroicons-exclamation-circle",description:"No data changes detected.",id:"modal-warning",color:"yellow"})},onClose(){C.close()}})};return $(U,()=>{o.value=1,u.fetchCategories()}),$(_,()=>{o.value=1,u.fetchCategories()}),$([o,_],()=>{u.fetchCategories()}),$(s,()=>{o.value=1,u.fetchCategories()}),(n,d)=>{const y=L;return F(),ae("div",null,[a(y,{"module-title":e(m),columns:e(h),"action-items":e(l),"table-data":e(x),"add-data-modal":b,loading:e(c),"action-handlers":{edit:i},pagination:{page:e(o),pageCount:e(_),total:e(p)},sorting:e(M),search:e(U),"selected-dropdown-filter":e(s),"enable-dropdown-filter":!0,"dropdown-filter-options":e(v),"onUpdate:page":d[0]||(d[0]=t=>o.value=t),"onUpdate:pageCount":d[1]||(d[1]=t=>_.value=t),"onUpdate:sort":e(u).fetchCategories,"onUpdate:search":d[2]||(d[2]=t=>U.value=t),"onUpdate:selectedDropdownFilter":d[3]||(d[3]=t=>s.value=t)},null,8,["module-title","columns","action-items","table-data","loading","action-handlers","pagination","sorting","search","selected-dropdown-filter","dropdown-filter-options","onUpdate:sort"])])}}});export{Me as default};
