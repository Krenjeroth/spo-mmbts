import{_ as U,d as q,c as O,o as $,a as X,h as z,f as k,m as Z,n as I,g as M,i as J,q as _,u as x,s as V,y as ee,v,z as w,x as ae,a0 as G,C as ne,D as S,E as C,K as te,a7 as le,a8 as re,a9 as ie,a2 as ue,M as oe,aa as se,ab as de,ac as ce,ad as N}from"#entry";import{u as fe}from"./_9ZTpig7.js";const m=_(C.ui.strategy,C.ui.input,te),ge=q({components:{UIcon:J},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>m.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(m.size).includes(e)}},color:{type:String,default:()=>m.default.color,validator(e){return[...C.ui.colors,...Object.keys(m.color)].includes(e)}},variant:{type:String,default:()=>m.default.variant,validator(e){return[...Object.keys(m.variant),...Object.values(m.color).flatMap(a=>Object.keys(a))].includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:a,slots:t}){const{ui:n,attrs:u}=x("input",V(e,"ui"),m,V(e,"class")),{size:d,rounded:r}=ee({ui:n,props:e}),{emitFormBlur:f,emitFormInput:j,size:y,color:c,inputId:l,name:o}=fe(e,m),i=v(()=>d.value??y.value),g=w(ae({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),p=w(null),b=()=>{e.autofocus&&p.value?.focus()},A=s=>{g.value.trim&&(s=s.trim()),(g.value.number||e.type==="number")&&(s=le(s)),g.value.nullify&&(s||=null),a("update:modelValue",s),j()},P=s=>{g.value.lazy||A(s.target.value)},T=s=>{if(e.type==="file"){const h=s.target.files;a("change",h)}else{const h=s.target.value;a("change",h),g.value.lazy&&A(h),g.value.trim&&(s.target.value=h.trim())}},W=s=>{f(),a("blur",s)};G(()=>{setTimeout(()=>{b()},e.autofocusDelay)});const Y=v(()=>{const s=n.value.color?.[c.value]?.[e.variant]||n.value.variant[e.variant];return ne(S(n.value.base,n.value.form,r.value,n.value.placeholder,e.type==="file"&&n.value.file.base,n.value.size[i.value],e.padded?n.value.padding[i.value]:"p-0",s?.replaceAll("{color}",c.value),(B.value||t.leading)&&n.value.leading.padding[i.value],(F.value||t.trailing)&&n.value.trailing.padding[i.value]),e.inputClass)}),B=v(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),F=v(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),D=v(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),L=v(()=>e.loading&&!B.value?e.loadingIcon:e.trailingIcon||e.icon),R=v(()=>S(n.value.icon.leading.wrapper,n.value.icon.leading.pointer,n.value.icon.leading.padding[i.value])),K=v(()=>S(n.value.icon.base,c.value&&C.ui.colors.includes(c.value)&&n.value.icon.color.replaceAll("{color}",c.value),n.value.icon.size[i.value],e.loading&&n.value.icon.loading)),H=v(()=>S(n.value.icon.trailing.wrapper,n.value.icon.trailing.pointer,n.value.icon.trailing.padding[i.value])),Q=v(()=>S(n.value.icon.base,c.value&&C.ui.colors.includes(c.value)&&n.value.icon.color.replaceAll("{color}",c.value),n.value.icon.size[i.value],e.loading&&!B.value&&n.value.icon.loading));return{ui:n,attrs:u,name:o,inputId:l,input:p,isLeading:B,isTrailing:F,inputClass:Y,leadingIconName:D,leadingIconClass:K,leadingWrapperIconClass:R,trailingIconName:L,trailingIconClass:Q,trailingWrapperIconClass:H,onInput:P,onChange:T,onBlur:W}}}),ve=["id","name","type","required","placeholder","disabled"];function me(e,a,t,n,u,d){const r=J;return $(),O("div",{class:I(e.type==="hidden"?"hidden":e.ui.wrapper)},[X("input",Z({id:e.inputId,ref:"input",name:e.name,type:e.type,required:e.required,placeholder:e.placeholder,disabled:e.disabled,class:e.inputClass},e.type==="file"?e.attrs:{...e.attrs,value:e.modelValue},{onInput:a[0]||(a[0]=(...f)=>e.onInput&&e.onInput(...f)),onBlur:a[1]||(a[1]=(...f)=>e.onBlur&&e.onBlur(...f)),onChange:a[2]||(a[2]=(...f)=>e.onChange&&e.onChange(...f))}),null,16,ve),z(e.$slots,"default"),e.isLeading&&e.leadingIconName||e.$slots.leading?($(),O("span",{key:0,class:I(e.leadingWrapperIconClass)},[z(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[M(r,{name:e.leadingIconName,class:I(e.leadingIconClass)},null,8,["name","class"])])],2)):k("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?($(),O("span",{key:1,class:I(e.trailingWrapperIconClass)},[z(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[M(r,{name:e.trailingIconName,class:I(e.trailingIconClass)},null,8,["name","class"])])],2)):k("",!0)],2)}const Ae=Object.assign(U(ge,[["render",me]]),{__name:"UInput"});class E extends Error{constructor(a){super(a),this.message=a,Object.setPrototypeOf(this,E.prototype)}}const pe=q({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:a,emit:t}){const n=oe(),u=se(`form-${n}`),d=w(null);G(()=>{u.on(async l=>{l.type!=="submit"&&e.validateOn?.includes(l.type)&&await y(l.path,{silent:!0})})}),de(()=>{u.reset()});const r=w([]);N("form-errors",r),N("form-events",u);const f=w({});N("form-inputs",f);async function j(){let l=await e.validate(e.state);if(e.schema){const{errors:o,result:i}=await $e(e.state,e.schema);o?l=l.concat(o):d.value=i}return l}async function y(l,o={silent:!1}){let i=l;if(l&&!Array.isArray(l)&&(i=[l]),i){const g=r.value.filter(b=>!i.includes(b.path)),p=(await j()).filter(b=>i.includes(b.path));r.value=g.concat(p)}else r.value=await j();if(r.value.length>0){if(o.silent)return!1;throw new E(`Form validation failed: ${JSON.stringify(r.value,null,2)}`)}return e.state}async function c(l){const o=l;try{e.validateOn?.includes("submit")&&await y(),o.data=e.schema?d.value:e.state,t("submit",o)}catch(i){if(!(i instanceof E))throw i;const g={...o,errors:r.value.map(p=>({...p,id:f.value[p.path]}))};t("error",g)}}return a({validate:y,errors:r,setErrors(l,o){o?r.value=r.value.filter(i=>i.path!==o).concat(l):r.value=l},async submit(){await c(new Event("submit"))},getErrors(l){return l?r.value.filter(o=>o.path===l):r.value},clear(l){l?r.value=r.value.filter(o=>o.path!==l):r.value=[]}}),{onSubmit:c,errors:ce(r)}}});function ye(e){return e.validate&&e.__isYupSchema__}function be(e){return e.inner!==void 0}function he(e){return"schema"in e&&typeof e.coercer=="function"&&typeof e.validator=="function"&&typeof e.refiner=="function"}function Ie(e){return e.validateAsync!==void 0&&e.id!==void 0}function Se(e){return e.isJoi===!0}function we(e){return"~standard"in e}async function Ce(e,a){const t=await a["~standard"].validate(e);return!t.issues||t.issues.length===0?{errors:null,result:"value"in t?t.value:null}:{errors:t.issues.map(u=>({path:u.path?.map(d=>typeof d=="object"?d.key:d).join(".")||"",message:u.message})),result:null}}async function je(e,a){try{return{errors:null,result:await a.validateAsync(e,{abortEarly:!1})}}catch(t){if(Se(t))return{errors:t.details.map(u=>({path:u.path.join("."),message:u.message})),result:null};throw t}}async function Be(e,a){const[t,n]=a.validate(e);return t?{errors:t.failures().map(d=>({message:d.message,path:d.path.join(".")})),result:null}:{errors:null,result:n}}async function Oe(e,a){try{return{errors:null,result:await a.validate(e,{abortEarly:!1})}}catch(t){if(be(t))return{errors:t.inner.map(u=>({path:u.path??"",message:u.message})),result:null};throw t}}function $e(e,a){if(we(a))return Ce(e,a);if(Ie(a))return je(e,a);if(ye(a))return Oe(e,a);if(he(a))return Be(e,a);throw new Error("Form validation failed: Unsupported form schema")}function ze(e,a,t,n,u,d){return $(),O("form",{onSubmit:a[0]||(a[0]=ue((...r)=>e.onSubmit&&e.onSubmit(...r),["prevent"]))},[z(e.$slots,"default",re(ie({errors:e.errors})))],32)}const Fe=Object.assign(U(pe,[["render",ze]]),{__name:"UForm"});export{Fe as _,Ae as a};
