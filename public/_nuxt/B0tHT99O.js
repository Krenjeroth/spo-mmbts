import{v as E,a4 as P,z as n}from"#entry";import{u as _}from"./bPUzXHqf.js";import{u as F,a as U}from"./CFo5vVrQ.js";function $(){const c=_(),{apiUrl:S}=F(),f="scores",s=E(()=>S(f));return{fetchScoresApi:async e=>await c(`${s.value}?${e.toString()}`),fetchScoreApi:async e=>await c(`${s.value}/${e}`),addScoreApi:async e=>await c(`${s.value}`,{method:"POST",body:e}),updateScoreApi:async(e,r)=>await c(`${s.value}/${e}`,{method:"PUT",body:r}),deleteScoreApi:async e=>await c(`${s.value}/${e}`,{method:"DELETE"}),bulkAddScoresApi:async e=>await c(`${s.value}/bulk`,{method:"POST",body:e}),fetchFinalistsApi:async e=>{const r=new URLSearchParams;return r.set("event_id",String(e.event_id)),e.limit&&r.set("limit",String(e.limit)),(e.category_slugs??[]).forEach(d=>r.append("category_slugs[]",d)),e.gender&&r.set("gender",e.gender),await c(`${s.value}/finalists?${r.toString()}`)}}}const O=P("scores",()=>{const{fetchScoresApi:c,addScoreApi:S,updateScoreApi:f,deleteScoreApi:s,bulkAddScoresApi:y}=$(),{hasError:A,errorBag:m,transformValidationErrors:l,resetErrorBag:i}=U();let v;(a=>{a.ASC="asc",a.DESC="desc"})(v||(v={}));const o=n([]),e=n(!1),r=n(1),d=n(5),g=n(""),b=n(""),p=n({column:"created_at",direction:"desc"}),h=n(0),w=n({male:[],female:[]});return{scores:o,loading:e,hasError:A,errorBag:m,page:r,pageCount:d,search:g,selectedStatus:b,sort:p,totalScore:h,fetchScores:async()=>{e.value=!0,i();try{const a=new URLSearchParams({page:r.value.toString(),per_page:d.value.toString(),sort:p.value.column,order:p.value.direction,search:g.value}),t=await c(a);o.value=t.data??t,console.log(o.value),h.value=Number(t.meta.total)||0}catch(a){l(a)}finally{e.value=!1}},fetchScoresByEvent:async a=>{e.value=!0,i();try{const t=new URLSearchParams({event_id:a.toString(),per_page:"999"}),u=await c(t);o.value=u.data??u,console.log(o.value),h.value=Number(u.meta.total)||0}catch(t){l(t)}finally{e.value=!1}},addScore:async a=>{e.value=!0,i();try{const t=await S(a);o.value.push(t.data??t)}catch(t){l(t)}finally{e.value=!1}},updateScore:async(a,t)=>{e.value=!0,i(),await f(a,t).catch(u=>{l(u)}).finally(()=>{e.value=!1})},deleteScore:async a=>{e.value=!0,i();try{await s(a),o.value=o.value.filter(t=>t.id!==a)}catch(t){l(t)}finally{e.value=!1}},bulkAddScores:async a=>{e.value=!0,i();try{await y(a)}catch(t){l(t)}finally{e.value=!1}},finalists:w,fetchFinalists:async a=>{e.value=!0,i();try{const{fetchFinalistsApi:t}=$(),u=await t(a);w.value=u.data??u}catch(t){l(t)}finally{e.value=!1}}}});export{O as u};
